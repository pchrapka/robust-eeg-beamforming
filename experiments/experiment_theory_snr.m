%% experiment_theory_snr

% source power levels, taken from SNR 0 dB average signal and noise
% var_signal = 0.0203; % not working
% var_noise = 0.0189;
% NOTE source power levels are before multiplication of leadfield
source_name = 'src_param_single_cortical_source_sine_2';

snr = 0;
% snr = 5;
% snr = 10;
vertex = 295;

switch snr
    case 10
        var_signal = 0.000143219;
        var_noise = 0.0190328;
    case 0
        %var_signal = 1.42451e-05;
        %var_noise = 0.0189432;
        %new version
        var_signal = 5.56672e-08;
        var_noise = 0.0189264;
    otherwise
        var_signal = 0.0005;
        var_noise = 1;
end

fprintf('theory\n');
fprintf('-----------------\n');
theory_snr_type1(...
    'sim_data_bem_1_100t',...
    source_name,...
    vertex,...
    'VarSignal',var_signal,...
    'VarNoise',var_noise,...
    'verbosity',0,...
    'CovType','theory');

fprintf('theory-signal\n');
fprintf('-----------------\n');
theory_snr_type1(...
    'sim_data_bem_1_100t',...
    source_name,...
    vertex,...
    'VarSignal',var_signal,...
    'VarNoise',var_noise,...
    'verbosity',0,...
    'CovType','theory-signal');

fprintf('data\n');
fprintf('-----------------\n');
theory_snr_type1(...
    'sim_data_bem_1_100t',...
    source_name,...
    vertex,...
    'snr',snr,...
    'CovType','data');